<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Extrato de Depósitos</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
body { background:#111; color:#eee; font-family:sans-serif; margin:0; padding:0; }
.container { max-width:600px; margin:20px auto; background:#222; border-radius:12px; padding:20px; box-shadow:0 0 20px #00ff88aa; }
h2 { color:#00ff88; text-align:center; margin-bottom: 20px; }
.depositos-list { list-style:none; padding:0; margin:0; }
.depositos-list li { background:#333; padding:15px; border-radius:10px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center; }
.depositos-list li span { display:block; }
.status-confirmado { color:#00ff88; font-weight:bold; }
.status-pendente { color:#ffcc00; font-weight:bold; }
.status-cancelado { color:#ff4444; font-weight:bold; }
</style>
</head>
<body>

<main class="container">
  <h2>Extrato de Depósitos</h2>
  <ul class="depositos-list" id="depositosList">
    <li>Carregando depósitos...</li>
  </ul>
</main>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCKSKnVC8dNWmiMrNr1j4rMLfQTlOrqzVM",
  authDomain: "hinvest-f4354.firebaseapp.com",
  databaseURL: "https://hinvest-f4354-default-rtdb.firebaseio.com",
  projectId: "hinvest-f4354",
  storageBucket: "hinvest-f4354.appspot.com",
  messagingSenderId: "646397677016",
  appId: "1:646397677016:web:f05ca27a38439568bff6ad"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const telefoneLogado = localStorage.getItem("telefoneLogado");
const depositosList = document.getElementById("depositosList");

if (!telefoneLogado) {
  alert("Você precisa estar logado para ver seus depósitos.");
  window.location.href = "index.html";
}

// Buscar depósitos do usuário logado
db.ref("depositos").orderByChild("telefone").equalTo(telefoneLogado).on("value", snapshot => {
  depositosList.innerHTML = "";
  if (!snapshot.exists()) {
    depositosList.innerHTML = "<li>Nenhum depósito encontrado.</li>";
    return;
  }

  snapshot.forEach(childSnap => {
    const dep = childSnap.val();
    const li = document.createElement("li");

    const valor = document.createElement("span");
    valor.textContent = `R$ ${parseFloat(dep.valor).toFixed(2)}`;

    const metodo = document.createElement("span");
    metodo.textContent = dep.metodo;

    const status = document.createElement("span");
    status.textContent = dep.status;
    if(dep.status === "confirmado") status.className = "status-confirmado";
    else if(dep.status === "pendente") status.className = "status-pendente";
    else if(dep.status === "cancelado") status.className = "status-cancelado";

    const data = document.createElement("span");
    const d = new Date(dep.data);
    data.textContent = d.toLocaleString();

    li.append(valor, metodo, status, data);
    depositosList.appendChild(li);
  });
});
</script>
</body>
</html>

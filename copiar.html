<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Copiar Chave PIX - Plataforma</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
body { background:#111; color:#eee; font-family:sans-serif; margin:0; padding:0; }
.container { max-width:500px; margin:20px auto; background:#222; border-radius:12px; padding:20px; box-shadow:0 0 20px #00ff88aa; }
h2 { color:#00ff88; }
.pix-key-box { background:#333; padding:15px; border-radius:10px; font-weight:bold; font-size:1.2rem; color:#00ff88; word-break: break-all; user-select: text; margin: 20px 0; display:flex; justify-content: space-between; align-items: center; }
button.copy-btn { background: linear-gradient(135deg,#00ff88,#0088ff); border:none; color:#000; font-weight:bold; padding:8px 14px; border-radius:8px; cursor:pointer; }
.btn-next { margin-top: 25px; background: linear-gradient(135deg,#00ff88,#0088ff); border:none; padding:12px; border-radius:8px; font-weight:bold; color:#000; cursor:pointer; width:100%; }
.info-text { font-size: 0.95rem; margin-top: 12px; color:#00ff88; }
#toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #00ff88; color: #000; padding: 12px 24px; border-radius: 30px; font-weight: bold; z-index: 9999; box-shadow: 0 0 12px #00ff88aa; opacity: 0; pointer-events: none; transition: opacity 0.4s ease, top 0.4s ease; }
#toast.show { opacity: 1; pointer-events: auto; top: 20px; }
</style>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCKSKnVC8dNWmiMrNr1j4rMLfQTlOrqzVM",
  authDomain: "hinvest-f4354.firebaseapp.com",
  databaseURL: "https://hinvest-f4354-default-rtdb.firebaseio.com",
  projectId: "hinvest-f4354",
  storageBucket: "hinvest-f4354.appspot.com",
  messagingSenderId: "646397677016",
  appId: "1:646397677016:web:f05ca27a38439568bff6ad"
};

const app = initializeApp(firebaseConfig);
const database = getDatabase(app);

// PIX Keys
const pixKeys = {
  60: "pix60@hfinvest.com",
  160: "pix160@hfinvest.com",
  300: "pix300@hfinvest.com",
  450: "pix450@hfinvest.com",
  500: "pix500@hfinvest.com",
  650: "pix650@hfinvest.com",
  700: "pix700@hfinvest.com",
  850: "pix850@hfinvest.com",
  900: "pix900@hfinvest.com",
  1050: "pix1050@hfinvest.com"
};

window.addEventListener("DOMContentLoaded", () => {
  const pixKeyEl = document.getElementById("pixKey");
  const copyBtn = document.getElementById("copyBtn");
  const toastEl = document.getElementById("toast");

  const depositoDados = JSON.parse(localStorage.getItem("depositoDados"));
  const telefoneLogado = localStorage.getItem("telefoneLogado");

  if (!depositoDados || !telefoneLogado || depositoDados.telefone !== telefoneLogado) {
    pixKeyEl.textContent = "Erro: nenhum depósito encontrado para sua conta.";
    copyBtn.disabled = true;
    return;
  }

  pixKeyEl.textContent = pixKeys[depositoDados.valor] || "Chave não encontrada.";

  copyBtn.addEventListener("click", () => {
    // Copiar a chave PIX
    navigator.clipboard.writeText(pixKeyEl.textContent).then(() => {
      showToast("Chave PIX copiada com sucesso!");

      // Enviar os dados do depósito para a página de confirmação
      localStorage.setItem("confirmarDepositoDados", JSON.stringify(depositoDados));

      // Redirecionar automaticamente para confirmar
      setTimeout(() => {
        window.location.href = "Confirmar-depósito.html";
      }, 800);
    }).catch(() => {
      alert("Erro ao copiar.");
    });
  });

  function showToast(msg){
    toastEl.textContent = msg;
    toastEl.classList.add("show");
    setTimeout(()=>toastEl.classList.remove("show"), 3000);
  }
});
</script>
</head>
<body>
<main class="container">
<h2>Copiar Chave PIX</h2>
<p class="info-text">Copie a chave PIX abaixo e será enviado automaticamente para a confirmação do depósito.</p>
<div class="pix-key-box">
  <span id="pixKey">...</span>
  <button class="copy-btn" id="copyBtn">Copiar & Confirmar</button>
</div>
<div id="toast"></div>
</main>
</body>
</html>
